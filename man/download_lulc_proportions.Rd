% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gee_helpers.R
\name{download_lulc_proportions}
\alias{download_lulc_proportions}
\title{Download LULC Class Proportions from GEE}
\usage{
download_lulc_proportions(
  boundary_layer,
  iso3,
  gee_project,
  output_dir = here::here(),
  lulc_product = c("esri_10m", "dynamic_world", "esa_worldcover"),
  class_names = c("agriculture", "built_area"),
  year = NULL,
  pus,
  wait_time = 30,
  force_download = FALSE
)
}
\arguments{
\item{boundary_layer}{An \code{sf} object defining the spatial boundary of interest.}

\item{iso3}{Character. Three-letter ISO country code for filename generation.}

\item{gee_project}{Character. Google Earth Engine cloud project ID. This is
required and must be a valid GEE project you have access to. Find your
project ID in the \href{https://code.earthengine.google.com/}{GEE Code Editor}.}

\item{output_dir}{Character. Path to directory for saving the final raster file.
Defaults to project root via \code{here::here()}.}

\item{lulc_product}{Character. LULC product to use: "esri_10m" (default),
"dynamic_world", or "esa_worldcover".}

\item{class_names}{Character vector. Names of classes to extract proportions for.
Default is c("agriculture", "built_area"). Must be valid class names for
the chosen \code{lulc_product} (see \code{\link[=get_lulc_classes]{get_lulc_classes()}}).}

\item{year}{Numeric or NULL. Year for LULC data. If NULL, uses most recent.}

\item{pus}{SpatRaster. Planning units raster (required for resolution).}

\item{wait_time}{Numeric. Maximum time in minutes to wait for the GEE export
to appear in Google Drive. Default is 5. Increase for large exports.}

\item{force_download}{Logical. If TRUE, skip local and Drive cache checks and
force a new export from GEE. Default is FALSE.}
}
\value{
A named list of \code{SpatRaster} objects, one per class. Each raster contains
proportion values (0-1) at PU resolution. Files are also saved to \code{output_dir}
with names like \verb{\{product\}_proportion_\{year\}_\{iso3\}_\{class\}.tif}.
}
\description{
Downloads individual proportion rasters from Google Earth Engine where each
raster represents the proportion (0-1) of a specific LULC class within each
planning unit cell. This is more efficient than downloading categorical LULC
and computing proportions locally, as aggregation happens in GEE.
}
\details{
This function:
\enumerate{
\item Loads the LULC ImageCollection in GEE
\item For each class, creates a binary mask (class = 1, other = 0)
\item Exports each class proportion as a separate GeoTIFF
\item Reprojects locally to PU CRS using bilinear interpolation
}

The resulting rasters can be used directly in consumer functions:
\itemize{
\item Use \code{props$agriculture} for \code{agricultural_areas_input}
\item Use \code{props$built_area} for \code{built_areas_input}
\item Values are already 0-1 proportions, ready for threshold comparison
}
}
\examples{
\dontrun{
# Download agriculture and built_area proportions
props <- download_lulc_proportions(
  boundary_layer = ghana_boundary,
  iso3 = "GHA",
  gee_project = "my-project",
  lulc_product = "esri_10m",
  class_names = c("agriculture", "built_area"),
  pus = planning_units
)

# Use directly in make_protect_zone
protect <- make_protect_zone(
  iso3 = "GHA",
  pus = planning_units,
  agricultural_areas_input = props$agriculture,
  built_areas_input = props$built_area,
  ...
)
}
}
\seealso{
\code{\link[=download_lulc_data]{download_lulc_data()}}, \code{\link[=get_lulc_classes]{get_lulc_classes()}}, \code{\link[=download_lulc_class_proportion]{download_lulc_class_proportion()}}
}
